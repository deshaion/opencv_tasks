На вход подается 3-мерная матрица как в молоке (скажем, 6 слоев).
В opencv tcnm есть алгоритм k-means, разбивающий это все на кластеры.
На выходе надо получить маску( 1-канальную матрицу CvMat), где каждый кластер обозначен своей яркостью.

На входе 3-мерная матрица. Мы ее превращаем в 2-мерную, где строки - это пред.строки*колонки
а в колонках количество каналов.

Далее создаем матрицу и заполняем ее по номеру кластера.
на входе у нас число кластеров.